<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui" />
<title>RectBlox - Free Puzzle Game | Match-3 Block Puzzle Online</title>

<!-- SEO Meta Tags -->
<meta name="description" content="Play RectBlox, a fun and addictive match-3 block puzzle game! Clear blocks, make combos, and progress through 5 challenging levels. Free to play online with no downloads required. Perfect for mobile and desktop gaming.">
<meta name="keywords" content="puzzle game, match 3, block puzzle, free game, online game, brain teaser, casual game, mobile game, HTML5 game, web game, strategy game, matching game">
<meta name="author" content="RectBlox Game">
<meta name="robots" content="index, follow">
<meta name="language" content="English">
<meta name="revisit-after" content="7 days">
<meta name="rating" content="General">
<meta name="distribution" content="Global">
<meta name="coverage" content="Worldwide">
<meta name="target" content="all">
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">

<!-- Open Graph / Facebook -->
<meta property="og:type" content="website">
<meta property="og:title" content="RectBlox - Free Match-3 Block Puzzle Game Online">
<meta property="og:description" content="Challenge yourself with RectBlox! A captivating match-3 puzzle game featuring 5 levels, combo chains, and addictive gameplay. Play free on any device - no download needed!">
<meta property="og:site_name" content="RectBlox - Free Online Puzzle Game">
<meta property="og:url" content="https://rectblox.com">
<meta property="og:locale" content="en_US">

<!-- Twitter -->
<meta property="twitter:card" content="summary_large_image">
<meta property="twitter:title" content="RectBlox - Free Match-3 Block Puzzle Game">
<meta property="twitter:description" content="Play RectBlox now! Addictive match-3 puzzle game with 5 challenging levels. Free online gaming at its finest - no downloads, just pure fun!">
<meta property="twitter:site" content="@RectBloxGame">
<meta property="twitter:creator" content="@RectBloxGame">>

<!-- Web App Settings -->
<meta name="theme-color" content="#f7e7ce">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="default">
<meta name="apple-mobile-web-app-title" content="RectBlox">

<!-- Performance and Caching -->
<meta http-equiv="Cache-Control" content="public, max-age=31536000">
<meta name="preconnect" href="https://pagead2.googlesyndication.com">
<meta name="dns-prefetch" href="https://pagead2.googlesyndication.com">
<meta name="preconnect" href="https://fonts.googleapis.com">
<meta name="dns-prefetch" href="https://fonts.gstatic.com">

<!-- Security headers -->
<meta http-equiv="X-Content-Type-Options" content="nosniff">
<meta http-equiv="X-Frame-Options" content="SAMEORIGIN">
<meta http-equiv="X-XSS-Protection" content="1; mode=block">

<!-- Canonical URL -->
<link rel="canonical" href="https://rectblox.com/">

<!-- Favicon and App Icons -->
<link rel="icon" type="image/png" sizes="32x32" href="logo.png">
<link rel="icon" type="image/png" sizes="16x16" href="logo.png">
<link rel="apple-touch-icon" href="logo.png">
<link rel="manifest" href="manifest.json">

<!-- Structured Data for Games -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Game",
  "name": "RectBlox",
  "description": "A fun and addictive match-3 block puzzle game with 5 challenging levels. Clear blocks, create combos, and achieve high scores in this free online puzzle game.",
  "genre": ["Puzzle", "Casual", "Strategy"],
  "gamePlatform": ["Web Browser", "Mobile", "Desktop", "Tablet"],
  "operatingSystem": ["Any", "Windows", "macOS", "Linux", "iOS", "Android"],
  "applicationCategory": "Game",
  "url": "https://rectblox.com",
  "sameAs": [
    "https://twitter.com/RectBloxGame",
    "https://facebook.com/RectBloxGame"
  ],
  "offers": {
    "@type": "Offer",
    "price": "0",
    "priceCurrency": "USD",
    "availability": "https://schema.org/InStock"
  },
  "aggregateRating": {
    "@type": "AggregateRating",
    "ratingValue": "4.7",
    "ratingCount": "250",
    "bestRating": "5",
    "worstRating": "1"
  },
  "creator": {
    "@type": "Organization",
    "name": "RectBlox Game Studio",
    "url": "https://rectblox.com"
  },
  "datePublished": "2024-12-01",
  "inLanguage": "en-US",
  "isAccessibleForFree": true,
  "keywords": "puzzle game, match-3, block puzzle, free online game, casual game, brain teaser",
  "educationalUse": "cognitive training, pattern recognition, strategic thinking",
  "typicalAgeRange": "8-99",
  "contentRating": {
    "@type": "Rating",
    "ratingValue": "Everyone"
  },
  "interactionStatistic": [
    {
      "@type": "InteractionCounter",
      "interactionType": "https://schema.org/PlayAction",
      "userInteractionCount": 5000
    }
  ],
  "gameItem": [
    {
      "@type": "Thing",
      "name": "Colored Blocks",
      "description": "Colorful puzzle blocks in various colors"
    },
    {
      "@type": "Thing", 
      "name": "Levels",
      "description": "5 progressive difficulty levels"
    },
    {
      "@type": "Thing",
      "name": "Scoring System", 
      "description": "Dynamic scoring with combo multipliers"
    }
  ]
}
</script>

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebApplication",
  "name": "RectBlox",
  "description": "Free online match-3 block puzzle game. No downloads required - play instantly in your browser!",
  "url": "https://rectblox.com",
  "applicationCategory": "GameApplication",
  "operatingSystem": "Web Browser",
  "offers": {
    "@type": "Offer",
    "price": "0",
    "priceCurrency": "USD"
  },
  "aggregateRating": {
    "@type": "AggregateRating", 
    "ratingValue": "4.7",
    "ratingCount": "250"
  },
  "screenshot": "https://rectblox.com/logo.png",
  "softwareVersion": "1.0",
  "dateModified": "2024-12-01",
  "browserRequirements": "HTML5, JavaScript enabled",
  "permissions": "none",
  "storageRequirements": "5MB",
  "supportingData": "Local storage for game progress"
}
</script>

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebSite",
  "name": "RectBlox - Free Online Puzzle Game",
  "url": "https://rectblox.com",
  "description": "Play the best free match-3 block puzzle game online. Challenge yourself with 5 levels of increasing difficulty.",
  "potentialAction": {
    "@type": "SearchAction",
    "target": "https://rectblox.com/?q={search_term_string}",
    "query-input": "required name=search_term_string"
  },
  "mainEntity": {
    "@type": "Game",
    "name": "RectBlox"
  }
}
</script>

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6244767628762401"
     crossorigin="anonymous"></script>
<style>
  html, body { 
    margin: 0; 
    padding: 0; 
    background: linear-gradient(135deg, #f7e7ce 0%, #e8c5a0 50%, #f2d7b6 100%);
    min-height: 100vh;
    height: 100vh;
    color: #6b4e3d;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
    overflow: hidden; /* 完全禁止滾動 */
    width: 100vw;
  }
  
  .container { 
    max-width: min(95vw, 500px);
    margin: 0 auto;
    padding: 5px 15px;
    height: 100vh;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    box-sizing: border-box;
    position: relative;
    overflow: hidden;
  }
  
  .game-wrapper {
    background: rgba(255, 255, 255, 0.8);
    backdrop-filter: blur(20px);
    border-radius: 20px;
    padding: 1rem;
    margin-bottom: 0;
    box-shadow: 
      0 6px 25px rgba(212, 165, 116, 0.25),
      0 2px 6px rgba(200, 149, 109, 0.15),
      inset 0 1px 0 rgba(255, 255, 255, 0.9);
    border: 1px solid rgba(212, 165, 116, 0.15);
    flex-shrink: 1;
    display: flex;
    flex-direction: column;
    height: fit-content;
    width: 100%;
    max-width: 480px;
  }
  
  .score-panel { 
    display: grid;
    grid-template-columns: 1fr auto 1fr;
    grid-template-rows: auto;
    gap: 0.6rem;
    margin-bottom: 0.8rem;
    width: 100%;
    align-items: center;
  }
  
  .level-info {
    background: linear-gradient(135deg, #b8926f 0%, #a67c52 100%);
    backdrop-filter: blur(10px);
    color: #ffffff; 
    padding: 0.6rem 1rem; 
    border-radius: 12px; 
    font-size: 0.8rem;
    font-weight: 600;
    border: 1px solid rgba(255, 255, 255, 0.2);
    box-shadow: 0 3px 12px rgba(184, 146, 111, 0.3);
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
    text-align: center;
    flex: 1;
    margin: 0 0.6rem;
  }
  
  .score-logo {
    grid-column: 2;
    width: 60px;
    height: 60px;
    border-radius: 16px;
    box-shadow: 0 3px 10px rgba(0, 0, 0, 0.15);
    transition: transform 0.3s ease;
  }
  
  .score-logo:hover {
    transform: scale(1.05);
  }
  
  .score-box { 
    background: linear-gradient(135deg, #d4a574 0%, #c8956d 100%);
    backdrop-filter: blur(10px);
    color: #ffffff; 
    padding: 0.9rem 1rem; 
    border-radius: 10px; 
    font-size: 1rem;
    font-weight: 600;
    border: 1px solid rgba(255, 255, 255, 0.2);
    box-shadow: 0 3px 12px rgba(212, 165, 116, 0.3);
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
    text-align: center;
  }
  
  .action-buttons {
    display: flex;
    gap: 0.6rem;
    margin-top: 0.8rem;
    width: 100%;
    align-items: center;
  }
  
  .secondary-button { 
    background: rgba(212, 165, 116, 0.15);
    backdrop-filter: blur(10px);
    color: #6b4e3d; 
    border: none; 
    padding: 0.6rem 1rem; 
    border-radius: 10px; 
    font-size: 0.75rem;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.3s ease;
    box-shadow: 0 2px 8px rgba(212, 165, 116, 0.15);
    border: 1px solid rgba(212, 165, 116, 0.2);
    flex: 1;
    text-align: center;
  }
  
  .secondary-button:hover {
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(212, 165, 116, 0.25);
    background: rgba(212, 165, 116, 0.25);
  }
  
  .secondary-button:active {
    transform: translateY(0px);
    box-shadow: 0 1px 4px rgba(212, 165, 116, 0.2);
  }
  
  button { 
    background: linear-gradient(135deg, #d4a574 0%, #c8956d 100%);
    color: #6b4e3d; 
    border: none; 
    padding: 0.75rem 1.25rem; 
    border-radius: 12px; 
    font-size: 0.9rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    box-shadow: 0 4px 15px rgba(212, 165, 116, 0.3);
    border: 1px solid rgba(255, 255, 255, 0.5);
    backdrop-filter: blur(10px);
  }
  
  button:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(212, 165, 116, 0.4);
    background: linear-gradient(135deg, #c8956d 0%, #d4a574 100%);
  }
  
  button:active {
    transform: translateY(0px);
    box-shadow: 0 2px 10px rgba(212, 165, 116, 0.3);
  }
  .game-container { 
    position: relative; 
    width: 100%;
    aspect-ratio: 1;
    max-width: 400px;
    margin: 0 auto;
    background: rgba(255, 255, 255, 0.1);
    backdrop-filter: blur(15px);
    border-radius: 16px; 
    padding: 0.8rem; 
    box-sizing: border-box;
    box-shadow: 
      inset 0 1px 0 rgba(255, 255, 255, 0.2),
      0 3px 12px rgba(0, 0, 0, 0.08);
    border: 1px solid rgba(255, 255, 255, 0.15);
    -webkit-touch-callout: none;
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
    touch-action: none; 
  }
  
  .grid-container { position:absolute; z-index:1; top:0.8rem; left:0.8rem; right:0.8rem; bottom:0.8rem; display:none; }
  .grid-cell { display:none; }
  .tile-container { position:absolute; z-index:2; top:0.8rem; left:0.8rem; right:0.8rem; bottom:0.8rem; }
  
  .overlay { 
    position:absolute; 
    top:0; 
    left:0; 
    width:100%; 
    height:100%; 
    background: rgba(0,0,0,0.8);
    backdrop-filter: blur(10px);
    display:none; 
    flex-direction:column; 
    align-items:center; 
    justify-content:center; 
    z-index:10;
    border-radius: 20px;
    cursor: pointer;
    -webkit-tap-highlight-color: transparent;
    touch-action: manipulation;
  }
  
  .overlay.show { display:flex; }
  
  .overlay .text { 
    color: #fff; 
    font-size: clamp(1.5rem, 4vw, 2.5rem);
    text-align: center; 
    margin-bottom: 1.5rem;
    font-weight: 600;
    text-shadow: 0 2px 4px rgba(0,0,0,0.3);
  }
  
  .score-summary {
    background: rgba(255, 255, 255, 0.9);
    backdrop-filter: blur(10px);
    border-radius: 16px;
    padding: 1.5rem;
    margin: 1rem 0;
    color: #6b4e3d;
    font-size: 1rem;
    line-height: 1.6;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
    border: 1px solid rgba(255, 255, 255, 0.3);
    max-width: 300px;
    cursor: pointer;
    transition: all 0.3s ease;
  }
  
  .score-summary:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.25);
  }
  
  .score-item {
    display: flex;
    justify-content: space-between;
    margin: 0.5rem 0;
    padding: 0.3rem 0;
    border-bottom: 1px solid rgba(107, 78, 61, 0.2);
  }
  
  .score-item:last-child {
    border-bottom: none;
    font-weight: bold;
    font-size: 1.1rem;
    color: #d4a574;
  }
  
  .overlay button { 
    background: linear-gradient(135deg, #d4a574 0%, #c8956d 100%);
    color: #6b4e3d;
    position: relative;
    z-index: 11;
    cursor: pointer;
    -webkit-tap-highlight-color: transparent;
    touch-action: manipulation;
    font-size: 1rem;
    padding: 1rem 2rem;
    border-radius: 16px;
    box-shadow: 0 4px 15px rgba(212, 165, 116, 0.3);
    border: 1px solid rgba(255, 255, 255, 0.5);
    backdrop-filter: blur(10px);
    margin: 0.5rem;
  }
  
  .instructions {
    background: rgba(255, 255, 255, 0.9);
    backdrop-filter: blur(10px);
    border-radius: 12px;
    padding: 1rem;
    margin: 0.5rem 0;
    color: #6b4e3d;
    font-size: 0.85rem;
    line-height: 1.4;
    box-shadow: 0 3px 10px rgba(0, 0, 0, 0.15);
    border: 1px solid rgba(255, 255, 255, 0.3);
    max-width: 250px;
    text-align: center;
    cursor: pointer;
    transition: all 0.3s ease;
  }
  
  .instructions:hover {
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
  }
  .tile { 
    position: absolute; 
    width: 90px; 
    height: 90px; 
    border-radius: 12px; 
    transition: all 150ms cubic-bezier(0.25, 0.46, 0.45, 0.94);
    text-align: center;
    font-weight: 700;
    font-size: 55px;
    line-height: 90px;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    box-shadow: 
      0 4px 8px rgba(0, 0, 0, 0.12),
      0 2px 4px rgba(0, 0, 0, 0.08);
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.2);
  }
  
  .tile:hover {
    filter: brightness(1.05);
    transform: translateZ(0) scale(1.02);
    box-shadow: 
      0 6px 12px rgba(0, 0, 0, 0.15),
      0 3px 6px rgba(0, 0, 0, 0.1);
  }
  .tile-new { 
    opacity: 0; 
    transform: scale(0); 
    animation: tile-appear 300ms ease-out forwards; 
  }
  .tile-remove { 
    animation: tile-explode 400ms ease-in forwards; 
    z-index: 10;
  }
  
  /* Appearance animation */
  @keyframes tile-appear {
    0% { opacity: 0; transform: scale(0) rotate(180deg); }
    50% { opacity: 0.8; transform: scale(1.1) rotate(90deg); }
    100% { opacity: 1; transform: scale(1) rotate(0deg); }
  }
  
  /* Explosion removal animation */
  @keyframes tile-explode {
    0% { 
      opacity: 1; 
      filter: brightness(1); 
    }
    25% { 
      opacity: 0.9; 
      filter: brightness(1.5) saturate(1.5); 
      box-shadow: 0 0 40px 15px currentColor; 
    }
    50% { 
      opacity: 0.7; 
      filter: brightness(2) saturate(2); 
      box-shadow: 0 0 60px 20px currentColor; 
    }
    75% { 
      opacity: 0.4; 
      filter: brightness(3) blur(2px); 
      box-shadow: 0 0 80px 25px currentColor; 
    }
    100% { 
      opacity: 0; 
      filter: brightness(0) blur(5px); 
      box-shadow: 0 0 100px 30px transparent; 
    }
  }
  
  /* Simplified pulse effect */
  @keyframes tile-pulse {
    0% { 
      opacity: 1;
      transform: scale(1);
      filter: brightness(1);
    }
    50% { 
      opacity: 0.3;
      transform: scale(1.1);
      filter: brightness(1.5);
    }
    100% { 
      opacity: 0;
      transform: scale(1);
      filter: brightness(1);
    }
  }
  
  /* Simplified particle effects */
  .particle {
    position: absolute;
    width: 4px;
    height: 4px;
    border-radius: 50%;
    pointer-events: none;
    z-index: 15;
    animation: particle-burst 400ms ease-out forwards;
  }
  
  @keyframes particle-burst {
    0% { 
      opacity: 1; 
      transform: scale(1); 
    }
    100% { 
      opacity: 0; 
      transform: scale(0) translate(var(--dx, 0), var(--dy, 0)); 
    }
  }
  
  /* Simplified ripple effect */
  @keyframes ripple-effect {
    0% { 
      opacity: 0.6; 
      transform: scale(0.8); 
    }
    100% { 
      opacity: 0; 
      transform: scale(2); 
    }
  }
  
  /* Combo effects */
  @keyframes combo-fade {
    0% { 
      opacity: 0; 
      transform: translate(-50%, -50%) scale(0.8); 
    }
    20% { 
      opacity: 1; 
      transform: translate(-50%, -50%) scale(1.1); 
    }
    80% { 
      opacity: 1; 
      transform: translate(-50%, -50%) scale(1); 
    }
    100% { 
      opacity: 0; 
      transform: translate(-50%, -60%) scale(0.9); 
    }
  }
  
  /* Pulse animation for instructions */
  @keyframes pulse {
    0% { opacity: 0.7; }
    50% { opacity: 1; }
    100% { opacity: 0.7; }
  }
  /* Color styles - warm milk tea colors */
  .tile-red   { 
    background: linear-gradient(135deg, #e8a87c 0%, #d27d2d 100%);
    color: #ffffff; 
    box-shadow: 
      0 4px 15px rgba(232, 168, 124, 0.3),
      0 2px 4px rgba(0, 0, 0, 0.1),
      inset 0 1px 0 rgba(255, 255, 255, 0.2);
    border: 1px solid rgba(255, 255, 255, 0.3);
  }
  
  .tile-green { 
    background: linear-gradient(135deg, #a8b47f 0%, #8e9c6e 100%);
    color: #ffffff; 
    box-shadow: 
      0 4px 15px rgba(168, 180, 127, 0.3),
      0 2px 4px rgba(0, 0, 0, 0.1),
      inset 0 1px 0 rgba(255, 255, 255, 0.2);
    border: 1px solid rgba(255, 255, 255, 0.3);
  }
  
  .tile-blue  { 
    background: linear-gradient(135deg, #9eb3c2 0%, #7a9bb8 100%);
    color: #ffffff; 
    box-shadow: 
      0 4px 15px rgba(158, 179, 194, 0.3),
      0 2px 4px rgba(0, 0, 0, 0.1),
      inset 0 1px 0 rgba(255, 255, 255, 0.2);
    border: 1px solid rgba(255, 255, 255, 0.3);
  }
  
  /* 4th color: warm purple */
  .tile-purple { 
    background: linear-gradient(135deg, #c8a2d8 0%, #b19bc8 100%);
    color: #ffffff; 
    box-shadow: 
      0 4px 15px rgba(200, 162, 216, 0.3),
      0 2px 4px rgba(0, 0, 0, 0.1),
      inset 0 1px 0 rgba(255, 255, 255, 0.2);
    border: 1px solid rgba(255, 255, 255, 0.3);
  }
  
  /* 5th color: bright yellow */
  .tile-orange { 
    background: linear-gradient(135deg, #f9c74f 0%, #f8961e 100%);
    color: #ffffff; 
    box-shadow: 
      0 4px 15px rgba(249, 199, 79, 0.3),
      0 2px 4px rgba(0, 0, 0, 0.1),
      inset 0 1px 0 rgba(255, 255, 255, 0.2);
    border: 1px solid rgba(255, 255, 255, 0.3);
  }
  
  /* 6th color: soft pink */
  .tile-pink { 
    background: linear-gradient(135deg, #e8a2b8 0%, #d48ba8 100%);
    color: #ffffff; 
    box-shadow: 
      0 4px 15px rgba(232, 162, 184, 0.3),
      0 2px 4px rgba(0, 0, 0, 0.1),
      inset 0 1px 0 rgba(255, 255, 255, 0.2);
    border: 1px solid rgba(255, 255, 255, 0.3);
  }
  
  /* 7th color: bright cyan */
  .tile-cyan { 
    background: linear-gradient(135deg, #7dd3fc 0%, #0ea5e9 100%);
    color: #ffffff; 
    box-shadow: 
      0 4px 15px rgba(125, 211, 252, 0.3),
      0 2px 4px rgba(0, 0, 0, 0.1),
      inset 0 1px 0 rgba(255, 255, 255, 0.2);
    border: 1px solid rgba(255, 255, 255, 0.3);
  }
  
  /* Responsive design */
  @media screen and (max-width: 768px) {
    .container { 
      padding: 0.5rem;
      height: 100vh;
      box-sizing: border-box;
    }
    
    .game-wrapper {
      padding: 0.8rem;
      border-radius: 16px;
      box-sizing: border-box;
      max-width: 100%;
    }
    
    .logo {
      width: 50px;
      height: 50px;
      margin-bottom: 0.2rem;
    }
    
    .score-panel { 
      grid-template-columns: 1fr auto 1fr;
      grid-template-rows: auto;
      gap: 0.4rem;
      margin-bottom: 0.6rem;
    }
    
    .score-logo {
      width: 40px;
      height: 40px;
      border-radius: 12px;
    }
    
    .level-info {
      font-size: 0.7rem;
      padding: 0.5rem 0.8rem;
      margin: 0 0.4rem;
    }
    
    .score-box {
      padding: 0.5rem 0.6rem;
      font-size: 0.7rem;
    }
    
    .action-buttons {
      gap: 0.4rem;
      margin-top: 0.6rem;
      align-items: center;
    }
    
    .secondary-button {
      padding: 0.5rem 0.8rem;
      font-size: 0.7rem;
      min-height: 36px;
    }
    
    
    .game-container { 
      max-width: 350px;
      padding: 0.6rem;
    }
    
    .tile-container, .grid-container { 
      top: 0.6rem; 
      left: 0.6rem; 
      right: 0.6rem; 
      bottom: 0.6rem;
    }
    
    .tile { 
      border-radius: 8px;
      font-size: clamp(1rem, 5vw, 1.5rem);
    }
    
    .overlay button {
      font-size: 0.85rem;
      padding: 0.8rem 1.5rem;
      min-height: 44px;
      margin-top: 0.5rem;
    }
    
    .overlay .text {
      font-size: clamp(1.1rem, 4.5vw, 1.8rem);
    }
  }
  
  /* Large screen optimization */
  @media screen and (min-width: 1200px) {
    .container {
      max-width: 700px;
      box-sizing: border-box;
      padding: 20px;
    }
    
    .game-wrapper {
      max-width: 600px;
      padding: 2rem;
      box-sizing: border-box;
    }
    
    .game-container {
      max-width: 550px;
    }
  }
  
  /* Extra scrollbar protection */
  * {
    box-sizing: border-box;
  }
  
  ::-webkit-scrollbar {
    display: none;
  }
  
  body {
    -ms-overflow-style: none;  /* IE and Edge */
    scrollbar-width: none;  /* Firefox */
  }
  
  /* Make moves counter larger since it's more important */
  #moves {
    font-size: 1.4em;
    font-weight: bold;
  }
  
  #score {
    font-size: 1.2em;
    font-weight: bold;
  }
  
  /* Additional Content Styles */
  .game-info, .help-section {
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(20px);
    border-radius: 20px;
    padding: 2rem;
    margin: 1rem 0;
    box-shadow: 0 6px 25px rgba(212, 165, 116, 0.25);
    border: 1px solid rgba(212, 165, 116, 0.15);
    max-height: 70vh;
    overflow-y: auto;
    color: #6b4e3d;
    line-height: 1.6;
  }
  
  .content-section {
    margin-bottom: 2rem;
  }
  
  .content-section h2 {
    color: #d4a574;
    border-bottom: 2px solid #d4a574;
    padding-bottom: 0.5rem;
    margin-bottom: 1rem;
  }
  
  .content-section h3 {
    color: #b8926f;
    margin-top: 1.5rem;
    margin-bottom: 1rem;
  }
  
  .content-section h4 {
    color: #8a6d5b;
    margin-top: 1rem;
    margin-bottom: 0.5rem;
  }
  
  .gameplay-guide .step {
    background: rgba(212, 165, 116, 0.1);
    padding: 1rem;
    margin: 1rem 0;
    border-radius: 10px;
    border-left: 4px solid #d4a574;
  }
  
  .faq-item {
    background: rgba(255, 255, 255, 0.5);
    padding: 1rem;
    margin: 1rem 0;
    border-radius: 10px;
    border: 1px solid rgba(212, 165, 116, 0.2);
  }
  
  .faq-item h4 {
    margin-top: 0;
    color: #6b4e3d;
  }
  
  /* Footer Styles */
  .game-footer {
    background: rgba(255, 255, 255, 0.9);
    backdrop-filter: blur(10px);
    border-radius: 15px;
    padding: 1.5rem;
    margin-top: 1rem;
    border: 1px solid rgba(212, 165, 116, 0.2);
    color: #6b4e3d;
  }
  
  .footer-content {
    display: grid;
    grid-template-columns: 1fr;
    gap: 1rem;
    text-align: center;
  }
  
  .footer-links {
    display: flex;
    justify-content: center;
    gap: 1rem;
    flex-wrap: wrap;
  }
  
  .footer-links a {
    color: #d4a574;
    text-decoration: none;
    padding: 0.5rem 1rem;
    border-radius: 8px;
    background: rgba(212, 165, 116, 0.1);
    transition: all 0.3s ease;
  }
  
  .footer-links a:hover {
    background: rgba(212, 165, 116, 0.2);
    transform: translateY(-1px);
  }
  
  .share-buttons {
    display: flex;
    gap: 0.5rem;
    justify-content: center;
    margin-top: 0.5rem;
  }
  
  .share-btn {
    background: linear-gradient(135deg, #4285f4 0%, #34a853 100%);
    color: white;
    border: none;
    padding: 0.5rem 1rem;
    border-radius: 8px;
    font-size: 0.8rem;
    cursor: pointer;
    transition: all 0.3s ease;
  }
  
  .share-btn:hover {
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(66, 133, 244, 0.3);
  }
  
  /* Modal Styles */
  .modal {
    position: fixed;
    z-index: 1000;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0,0,0,0.5);
    backdrop-filter: blur(5px);
  }
  
  .modal-content {
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(20px);
    margin: 5% auto;
    padding: 2rem;
    border-radius: 20px;
    width: 90%;
    max-width: 600px;
    max-height: 80vh;
    overflow-y: auto;
    position: relative;
    color: #6b4e3d;
    box-shadow: 0 10px 30px rgba(0,0,0,0.3);
  }
  
  .close {
    position: absolute;
    right: 1rem;
    top: 1rem;
    color: #aaa;
    font-size: 28px;
    font-weight: bold;
    cursor: pointer;
    transition: color 0.3s ease;
  }
  
  .close:hover {
    color: #6b4e3d;
  }
  
  /* Contact Form Styles */
  .contact-form {
    margin: 1.5rem 0;
  }
  
  .form-group {
    margin-bottom: 1rem;
  }
  
  .form-group label {
    display: block;
    margin-bottom: 0.5rem;
    font-weight: 600;
    color: #6b4e3d;
  }
  
  .form-group input,
  .form-group select,
  .form-group textarea {
    width: 100%;
    padding: 0.75rem;
    border: 2px solid rgba(212, 165, 116, 0.3);
    border-radius: 8px;
    font-size: 1rem;
    background: rgba(255, 255, 255, 0.8);
    color: #6b4e3d;
    transition: border-color 0.3s ease;
  }
  
  .form-group input:focus,
  .form-group select:focus,
  .form-group textarea:focus {
    outline: none;
    border-color: #d4a574;
    box-shadow: 0 0 0 3px rgba(212, 165, 116, 0.1);
  }
  
  .submit-btn {
    background: linear-gradient(135deg, #d4a574 0%, #c8956d 100%);
    color: white;
    border: none;
    padding: 1rem 2rem;
    border-radius: 12px;
    font-size: 1rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    width: 100%;
  }
  
  .submit-btn:hover {
    transform: translateY(-1px);
    box-shadow: 0 4px 15px rgba(212, 165, 116, 0.3);
  }
  
  /* Mobile Responsive Updates */
  @media screen and (max-width: 768px) {
    .game-info, .help-section {
      padding: 1rem;
      max-height: 60vh;
    }
    
    .modal-content {
      margin: 2% auto;
      padding: 1rem;
      width: 95%;
      max-height: 90vh;
    }
    
    .footer-content {
      gap: 0.5rem;
    }
    
    .footer-links {
      flex-direction: column;
      gap: 0.5rem;
    }
    
    .share-buttons {
      flex-direction: column;
    }
    
    .side-ad-container {
      display: none !important;
    }
  }
  
  /* Desktop ad positioning */
  @media screen and (min-width: 1200px) {
    .side-ad-container {
      display: block !important;
      position: fixed;
      right: 10px;
      top: 50%;
      transform: translateY(-50%);
      width: 160px;
      z-index: 5;
    }
    
    .container {
      margin-right: 180px; /* Make room for side ad */
    }
  }
  
  /* Ad container styling */
  .ad-container {
    margin: 1rem auto;
    max-width: 100%;
    text-align: center;
  }
  
  .ad-container ins {
    display: block;
    text-align: center;
  }
</style>
</head>
<body>
<div class="container">
  <div class="game-wrapper">
    <div class="score-panel">
      <div class="score-box">Moves: <span id="moves">40</span></div>
      <img src="logo.png" alt="RectBlox Logo" class="score-logo">
      <div class="score-box" style="background: linear-gradient(135deg, #a8b47f 0%, #8e9c6e 100%);">Score: <span id="score">0</span></div>
    </div>
    
    <div class="game-container" id="game">
      <div class="grid-container" id="grid"></div>
      <div class="tile-container" id="tiles"></div>
      <div class="overlay" id="overlay">
        <div class="text" id="overlayText"></div>
        <div class="score-summary" id="scoreSummary" style="display: none;"></div>
        <div class="instructions" id="instructions" style="display: none;">
          <div style="margin-bottom: 0.8rem; font-size: 1rem; color: #d4a574; font-weight: bold;">How to Play</div>
          <div style="margin-bottom: 0.6rem;">💻 Computer: Arrow keys ⬅️ ➡️ ⬆️ ⬇️</div>
          <div style="margin-bottom: 1rem;">📱 Mobile: Swipe screen</div>
          <div style="font-size: 0.8rem; color: #8a6d5b; margin-bottom: 0.8rem;">Match same colors to remove blocks!</div>
          <div style="font-size: 0.75rem; color: #a8926f; font-style: italic; animation: pulse 2s infinite;">👆 Tap here or anywhere to start game</div>
        </div>
        <button id="overlayRestartBtn">Play Again</button>
        <button id="instructionsBtn" style="display: none;">Start Game</button>
      </div>
    </div>
    
    <div class="action-buttons">
      <button class="secondary-button" id="shuffleBtn">Reset Position</button>
      <div class="level-info">Level <span id="level">1</span>: <span id="levelName">Easy Level</span></div>
      <button class="secondary-button" id="restartBtn">Restart</button>
    </div>
  </div>
  
  <!-- Additional Game Content Sections -->
  <div class="game-navigation" style="text-align: center; margin: 1rem 0;">
    <div class="action-buttons">
      <button class="secondary-button" id="aboutBtn">About Game</button>
      <button class="secondary-button" id="helpBtn">Help</button>
    </div>
  </div>
</div>
<script>
// Game level settings
const LEVELS = {
  1: { size: 5, colors: ['red', 'green', 'blue'], initialMoves: 40, name: 'Easy Level' },
  2: { size: 6, colors: ['red', 'green', 'blue', 'purple'], name: 'Medium Level' },
  3: { size: 7, colors: ['red', 'green', 'blue', 'purple', 'orange'], name: 'Hard Level' },
  4: { size: 8, colors: ['red', 'green', 'blue', 'purple', 'orange', 'pink'], name: 'Super Hard' },
  5: { size: 9, colors: ['red', 'green', 'blue', 'purple', 'orange', 'pink', 'cyan'], name: 'Ultimate Challenge' }
};

let currentLevel = 1;
let SIZE = LEVELS[currentLevel].size;
let PROPS = LEVELS[currentLevel].colors;
let boardMatrix = [];
let boardElements = [];
let movesLeft = LEVELS[currentLevel].initialMoves; // Set initial moves only at start
let isAnimating = false;
let gameScore = 0;
let levelScores = []; // Record scores for each level
let totalBlocks = 0; // Track total blocks removed
let chainCount = 0; // Track chain count for cascading sound effects
let totalChainBlocks = 0; // Track total blocks in current chain

// Audio context for sound effects
let audioContext;
try {
  audioContext = new (window.AudioContext || window.webkitAudioContext)();
} catch(e) {
  console.log('Audio not supported');
}

// Sound effect functions
function playSound(frequency, duration, type = 'sine', volume = 0.1) {
  if (!audioContext) return;
  
  const oscillator = audioContext.createOscillator();
  const gainNode = audioContext.createGain();
  
  oscillator.connect(gainNode);
  gainNode.connect(audioContext.destination);
  
  oscillator.frequency.setValueAtTime(frequency, audioContext.currentTime);
  oscillator.type = type;
  
  gainNode.gain.setValueAtTime(0, audioContext.currentTime);
  gainNode.gain.linearRampToValueAtTime(volume, audioContext.currentTime + 0.01);
  gainNode.gain.exponentialRampToValueAtTime(0.001, audioContext.currentTime + duration);
  
  oscillator.start(audioContext.currentTime);
  oscillator.stop(audioContext.currentTime + duration);
}

function playMatchSound() {
  playSound(440, 0.2, 'sine', 0.2); // A4 note - increased volume
}

function playComboSound() {
  playSound(523, 0.3, 'sine', 0.25); // C5 note - increased volume
  setTimeout(() => playSound(659, 0.3, 'sine', 0.25), 100); // E5 note
}

function playEliminationSound(matchCount, chainLevel = 0, totalChainMatches = 0) {
  // Calculate enhanced match count based on chain level and total chain matches
  const enhancedCount = matchCount + (chainLevel * 2) + Math.floor(totalChainMatches / 3);
  
  // Dynamic sound based on elimination count - more blocks = more epic sound!
  if (enhancedCount <= 1) {
    // Single block - simple pop
    playSound(440, 0.15, 'sine', 0.15);
  } else if (enhancedCount <= 2) {
    // Two blocks - double pop
    playSound(440, 0.15, 'sine', 0.18);
    setTimeout(() => playSound(523, 0.15, 'sine', 0.18), 80);
  } else if (enhancedCount <= 4) {
    // 3-4 blocks - nice combo
    playSound(523, 0.2, 'sine', 0.22);
    setTimeout(() => playSound(659, 0.2, 'sine', 0.22), 100);
    setTimeout(() => playSound(784, 0.2, 'sine', 0.22), 200);
  } else if (enhancedCount <= 7) {
    // 5-7 blocks - awesome combo
    playSound(523, 0.25, 'sine', 0.25);
    setTimeout(() => playSound(659, 0.25, 'sine', 0.25), 80);
    setTimeout(() => playSound(784, 0.25, 'sine', 0.25), 160);
    setTimeout(() => playSound(880, 0.25, 'sine', 0.25), 240);
  } else if (enhancedCount <= 12) {
    // 8-12 blocks - epic combo
    playSound(523, 0.3, 'sine', 0.28);
    setTimeout(() => playSound(659, 0.3, 'sine', 0.28), 60);
    setTimeout(() => playSound(784, 0.3, 'sine', 0.28), 120);
    setTimeout(() => playSound(880, 0.3, 'sine', 0.28), 180);
    setTimeout(() => playSound(1047, 0.3, 'sine', 0.28), 240); // C6
  } else if (enhancedCount <= 20) {
    // 13-20 blocks - legendary combo
    playSound(523, 0.4, 'sine', 0.35);
    setTimeout(() => playSound(659, 0.4, 'sine', 0.35), 40);
    setTimeout(() => playSound(784, 0.4, 'sine', 0.35), 80);
    setTimeout(() => playSound(880, 0.4, 'sine', 0.35), 120);
    setTimeout(() => playSound(1047, 0.4, 'sine', 0.35), 160); // C6
    setTimeout(() => playSound(1175, 0.4, 'sine', 0.35), 200); // D6
    setTimeout(() => playSound(1319, 0.5, 'sine', 0.35), 240); // E6
    setTimeout(() => playSound(1568, 0.5, 'sine', 0.35), 280); // G6 - extra high note
  } else {
    // 21+ blocks - GODLIKE combo with extra epic sound
    playSound(523, 0.5, 'sine', 0.4);
    setTimeout(() => playSound(659, 0.5, 'sine', 0.4), 30);
    setTimeout(() => playSound(784, 0.5, 'sine', 0.4), 60);
    setTimeout(() => playSound(880, 0.5, 'sine', 0.4), 90);
    setTimeout(() => playSound(1047, 0.5, 'sine', 0.4), 120); // C6
    setTimeout(() => playSound(1175, 0.5, 'sine', 0.4), 150); // D6
    setTimeout(() => playSound(1319, 0.5, 'sine', 0.4), 180); // E6
    setTimeout(() => playSound(1568, 0.5, 'sine', 0.4), 210); // G6
    setTimeout(() => playSound(1760, 0.6, 'sine', 0.4), 240); // A6 - ultra high note
    setTimeout(() => playSound(2093, 0.6, 'sine', 0.4), 270); // C7 - extreme high note
  }
}

function playLevelCompleteSound() {
  playSound(523, 0.2, 'sine', 0.2); // C5 - increased volume
  setTimeout(() => playSound(659, 0.2, 'sine', 0.2), 150); // E5
  setTimeout(() => playSound(784, 0.3, 'sine', 0.2), 300); // G5
}

function playShuffleSound() {
  playSound(330, 0.1, 'sawtooth', 0.15); // increased volume
  setTimeout(() => playSound(370, 0.1, 'sawtooth', 0.15), 50);
  setTimeout(() => playSound(294, 0.1, 'sawtooth', 0.15), 100);
}

function playButtonSound() {
  playSound(800, 0.1, 'square', 0.1); // increased volume
}

function playMoveSound() {
  playSound(200, 0.05, 'triangle', 0.06); // increased volume
}

const movesEl          = document.getElementById('moves');
const levelEl          = document.getElementById('level');
const levelNameEl      = document.getElementById('levelName');
const scoreEl          = document.getElementById('score');
const overlay          = document.getElementById('overlay');
const overlayText      = document.getElementById('overlayText');
const tileContainer    = document.getElementById('tiles');
const shuffleBtn       = document.getElementById('shuffleBtn');
const restartBtn       = document.getElementById('restartBtn');
const overlayRestartBtn= document.getElementById('overlayRestartBtn');
const instructionsDiv  = document.getElementById('instructions');
const instructionsBtn  = document.getElementById('instructionsBtn');

function initGrid() {
  // Background grid removed, no need to create
}

function createTile(x, y, color) {
  const tile = document.createElement('div');
  tile.className = `tile tile-${color} tile-new`;
  
  // Responsive size calculation - adjust based on current level size
  const gameContainer = document.querySelector('.game-container');
  const containerRect = gameContainer.getBoundingClientRect();
  const containerSize = Math.min(containerRect.width, containerRect.height) - 32; // Remove padding
  const tileSize = (containerSize - (SIZE-1) * 8) / SIZE; // Calculate dynamically based on SIZE
  const gap = 8;
  
  tile.style.width = `${tileSize}px`;
  tile.style.height = `${tileSize}px`;
  tile.style.lineHeight = `${tileSize}px`;
  tile.style.fontSize = `${Math.min(tileSize * 0.6, 28)}px`;
  tile.style.transform = `translate(${x * (tileSize + gap)}px, ${y * (tileSize + gap)}px)`;
  
  tileContainer.appendChild(tile);
  requestAnimationFrame(() => tile.classList.remove('tile-new'));
  return tile;
}

function updateGameSettings() {
  SIZE = LEVELS[currentLevel].size;
  PROPS = LEVELS[currentLevel].colors;
  // Don't reset moves, let them carry over to next level
}

function initBoard() {
  updateGameSettings();
  boardMatrix   = Array.from({length:SIZE}, ()=>Array(SIZE).fill(null));
  boardElements = Array.from({length:SIZE}, ()=>Array(SIZE).fill(null));
  tileContainer.innerHTML = '';
  isAnimating = false;
  hideOverlay(); 
  updateUI();
  
  const initial = Math.floor((SIZE*SIZE)/2);
  for (let i = 0; i < initial; i++) {
    let x, y;
    do { x = Math.floor(Math.random()*SIZE); y = Math.floor(Math.random()*SIZE); }
    while (boardMatrix[y][x] != null);
    const c = PROPS[Math.floor(Math.random()*PROPS.length)];
    boardMatrix[y][x] = c;
    boardElements[y][x] = createTile(x,y,c);
  }
}

function updateUI() {
  movesEl.textContent = movesLeft;
  levelEl.textContent = currentLevel;
  levelNameEl.textContent = LEVELS[currentLevel].name;
  
  // Calculate total score: completed levels + current level game score
  const completedLevelsScore = levelScores.reduce((sum, level) => sum + level.score, 0);
  const totalDisplayScore = completedLevelsScore + gameScore;
  scoreEl.textContent = totalDisplayScore;
}

function nextLevel() {
  // Record current level score (including current gameScore)
  const levelScore = calculateLevelScore();
  levelScores.push({
    level: currentLevel,
    score: levelScore + gameScore, // Include current game score
    remainingMoves: movesLeft
  });
  
  if (currentLevel < Object.keys(LEVELS).length) {
    // Show short message, then go to next level
    showScoreMessage(`Level ${currentLevel} Done! Got ${levelScore + gameScore} points`, 0);
    currentLevel++;
    gameScore = 0; // Reset game score for next level
    
    // Wait a bit for player to see message, then go to next level
    setTimeout(() => {
      initBoard();
    }, 1500);
  } else {
    // Last level done, show final score
    showGameCompleteOverlay();
  }
}

function calculateLevelScore() {
  // Calculate score based on remaining moves and level difficulty
  const baseScore = 1000;
  const moveBonus = movesLeft * 50; // 50 points per remaining move
  const levelMultiplier = currentLevel; // Level multiplier
  return Math.floor((baseScore + moveBonus) * levelMultiplier);
}

function showGameCompleteOverlay() {
  // If current level score not recorded yet, record it first
  if (!levelScores.length || levelScores[levelScores.length - 1].level !== currentLevel) {
    const levelScore = calculateLevelScore();
    levelScores.push({
      level: currentLevel,
      score: levelScore + gameScore, // Include current game score
      remainingMoves: movesLeft
    });
  }
  
  // Calculate total score from all recorded level scores
  const totalScore = levelScores.reduce((sum, level) => sum + level.score, 0);
  const totalRemainingMoves = levelScores.reduce((sum, level) => sum + level.remainingMoves, 0);
  const scoreSummary = document.getElementById('scoreSummary');
  
  // Always show "No More Moves!" regardless of completion status
  const titleText = '📊 No More Moves! 📊';
  
  let summaryHTML = `<h3 style="margin: 0 0 1.5rem 0; color: #d4a574; font-size: 1.4rem;">${titleText}</h3>`;
  
  // Only show summary stats, no individual level scores
  summaryHTML += `
    <div class="score-item" style="font-size: 1.1rem; margin-bottom: 0.8rem;">
      <span>Total Blocks Removed</span>
      <span>${totalBlocks}</span>
    </div>
    <div class="score-item" style="font-size: 1.1rem; margin-bottom: 0.8rem;">
      <span>Total Moves Saved</span>
      <span>${totalRemainingMoves}</span>
    </div>
    <div class="score-item" style="font-size: 1.3rem; font-weight: bold; color: #d4a574; border-top: 2px solid #d4a574; padding-top: 1rem; margin-top: 1rem;">
      <span>Final Score</span>
      <span>${totalScore.toLocaleString()} points</span>
    </div>
  `;
  
  // Add click instruction at the bottom with delay message
  summaryHTML += `<div id="clickInstruction" style="margin-top: 1.5rem; font-size: 0.8rem; color: #a8926f; text-align: center; font-style: italic; opacity: 0.5;">Please wait 1 second...</div>`;
  
  scoreSummary.innerHTML = summaryHTML;
  scoreSummary.style.display = 'block';
  
  const overlayMessage = 'No More Moves!';
  showOverlay(overlayMessage);
  
  // Add 1 second delay before allowing interaction
  let canClick = false;
  setTimeout(() => {
    canClick = true;
    const instruction = document.getElementById('clickInstruction');
    if (instruction) {
      instruction.textContent = '👆 Tap anywhere to restart game';
      instruction.style.opacity = '1';
    }
  }, 1000);
  
  // Add event listeners for clicking anywhere to restart (with delay check)
  const handleGameCompleteClick = (e) => {
    if (canClick) {
      overlay.removeEventListener('click', handleGameCompleteClick);
      overlay.removeEventListener('touchend', handleGameCompleteTouch);
      restartGame();
    }
  };
  
  const handleGameCompleteTouch = (e) => {
    if (canClick) {
      e.preventDefault();
      e.stopPropagation();
      overlay.removeEventListener('click', handleGameCompleteClick);
      overlay.removeEventListener('touchend', handleGameCompleteTouch);
      restartGame();
    }
  };
  
  overlay.addEventListener('click', handleGameCompleteClick);
  overlay.addEventListener('touchend', handleGameCompleteTouch);
}

function restartGame() {
  currentLevel = 1;
  movesLeft = LEVELS[1].initialMoves;
  gameScore = 0;
  levelScores = [];
  totalBlocks = 0;
  document.getElementById('scoreSummary').style.display = 'none';
  initBoard();
  setTimeout(() => showInstructions(), 500);
}

// Add event listeners for score summary click
document.getElementById('scoreSummary').addEventListener('click', function(e) {
  e.stopPropagation();
  // Click on score summary also restarts game
  restartGame();
});

document.getElementById('scoreSummary').addEventListener('touchend', function(e) {
  e.preventDefault();
  e.stopPropagation();
  // Touch on score summary also restarts game
  restartGame();
});

function showOverlay(msg) { 
  overlayText.textContent = msg; 
  overlay.classList.add('show'); 
}

function hideOverlay() { 
  overlay.classList.remove('show');
  // Reset overlay elements
  instructionsDiv.style.display = 'none';
  overlayRestartBtn.style.display = 'inline-block';
  instructionsBtn.style.display = 'none';
  
  // Clean up event listeners
  overlay.removeEventListener('click', startGameFromInstructions);
  overlay.removeEventListener('touchend', startGameFromInstructionsTouch);
}

function showInstructions() {
  overlayText.textContent = '';
  instructionsDiv.style.display = 'block';
  overlayRestartBtn.style.display = 'none';
  instructionsBtn.style.display = 'none';
  overlay.classList.add('show');
  
  // 點擊overlay任何地方都可以開始遊戲 - 同時支援滑鼠和觸控
  overlay.addEventListener('click', startGameFromInstructions);
  overlay.addEventListener('touchend', startGameFromInstructionsTouch);
}

function startGameFromInstructions(e) {
  // 防止事件冒泡到instructions div
  if (e.target === instructionsDiv || instructionsDiv.contains(e.target)) {
    return;
  }
  overlay.removeEventListener('click', startGameFromInstructions);
  overlay.removeEventListener('touchend', startGameFromInstructionsTouch);
  hideOverlay();
}

function startGameFromInstructionsTouch(e) {
  e.preventDefault();
  e.stopPropagation();
  // 防止事件冒泡到instructions div
  if (e.target === instructionsDiv || instructionsDiv.contains(e.target)) {
    return;
  }
  overlay.removeEventListener('click', startGameFromInstructions);
  overlay.removeEventListener('touchend', startGameFromInstructionsTouch);
  hideOverlay();
}

shuffleBtn.addEventListener('click', ()=>{
  if (isAnimating || movesLeft < 1) return alert('Not enough moves! Need at least 1 move to reset position');
  
  playButtonSound(); // Play button sound
  // Show shuffle confirmation dialog
  showShuffleConfirmation();
});

restartBtn.addEventListener('click', () => {
  playButtonSound(); // Play button sound
  restartGame();
});

overlayRestartBtn.addEventListener('click', () => {
  playButtonSound(); // Play button sound
  restartGame();
});

// Add touch support for mobile
overlayRestartBtn.addEventListener('touchend', function(e) {
  e.preventDefault();
  e.stopPropagation();
  restartGame();
});

shuffleBtn.addEventListener('touchend', function(e) {
  e.preventDefault();
  e.stopPropagation();
  if (isAnimating || movesLeft < 1) return alert('Not enough moves! Need at least 1 move to mix blocks');
  
  // Show shuffle confirmation dialog
  showShuffleConfirmation();
});

restartBtn.addEventListener('touchend', function(e) {
  e.preventDefault();
  e.stopPropagation();
  restartGame();
});

function showShuffleConfirmation() {
  // Create overlay for shuffle confirmation
  const shuffleOverlay = document.createElement('div');
  shuffleOverlay.className = 'overlay';
  shuffleOverlay.style.display = 'flex';
  shuffleOverlay.style.zIndex = '20';
  
  const confirmBox = document.createElement('div');
  confirmBox.style.background = 'rgba(255, 255, 255, 0.95)';
  confirmBox.style.borderRadius = '20px';
  confirmBox.style.padding = '2rem';
  confirmBox.style.maxWidth = '300px';
  confirmBox.style.textAlign = 'center';
  confirmBox.style.boxShadow = '0 10px 30px rgba(0,0,0,0.3)';
  confirmBox.style.border = '2px solid #d4a574';
  
  confirmBox.innerHTML = `
    <h3 style="margin: 0 0 1rem 0; color: #6b4e3d; font-size: 1.2rem;">Reset Position</h3>
    <p style="margin: 0 0 1.5rem 0; color: #8a6d5b; font-size: 0.9rem; line-height: 1.4;">
      Mix up all blocks to new spots.<br>
      <strong>Cost: 1 move</strong>
    </p>
    <div style="display: flex; gap: 1rem; justify-content: center;">
      <button id="shuffleYes" style="
        background: linear-gradient(135deg, #d4a574 0%, #c8956d 100%);
        color: white;
        border: none;
        padding: 0.8rem 1.5rem;
        border-radius: 10px;
        font-size: 0.9rem;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        box-shadow: 0 3px 10px rgba(212, 165, 116, 0.3);
      ">Yes</button>
      <button id="shuffleNo" style="
        background: rgba(212, 165, 116, 0.2);
        color: #6b4e3d;
        border: 1px solid #d4a574;
        padding: 0.8rem 1.5rem;
        border-radius: 10px;
        font-size: 0.9rem;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
      ">No</button>
    </div>
  `;
  
  shuffleOverlay.appendChild(confirmBox);
  document.querySelector('.game-container').appendChild(shuffleOverlay);
  
  // Add event listeners for Yes/No buttons
  document.getElementById('shuffleYes').addEventListener('click', () => {
    movesLeft -= 1;
    updateUI();
    playShuffleSound(); // Play shuffle sound
    shuffleTiles();
    document.querySelector('.game-container').removeChild(shuffleOverlay);
  });
  
  document.getElementById('shuffleNo').addEventListener('click', () => {
    document.querySelector('.game-container').removeChild(shuffleOverlay);
  });
  
  // Close on overlay click
  shuffleOverlay.addEventListener('click', (e) => {
    if (e.target === shuffleOverlay) {
      document.querySelector('.game-container').removeChild(shuffleOverlay);
    }
  });
}

function shuffleTiles() {
  // Collect all current tiles
  const allTiles = [];
  boardMatrix.forEach(row => {
    row.forEach(cell => {
      if (cell) allTiles.push(cell);
    });
  });
  
  // Clear the board
  tileContainer.innerHTML = '';
  for (let y = 0; y < SIZE; y++) {
    for (let x = 0; x < SIZE; x++) {
      boardMatrix[y][x] = null;
      boardElements[y][x] = null;
    }
  }
  
  // Get all possible positions
  const allPositions = [];
  for (let y = 0; y < SIZE; y++) {
    for (let x = 0; x < SIZE; x++) {
      allPositions.push({x, y});
    }
  }
  
  // Randomly shuffle positions
  for (let i = allPositions.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [allPositions[i], allPositions[j]] = [allPositions[j], allPositions[i]];
  }
  
  // Place tiles in new random positions
  allTiles.forEach((color, index) => {
    const {x, y} = allPositions[index];
    boardMatrix[y][x] = color;
    boardElements[y][x] = createTile(x, y, color);
  });
}

// Handle move directions
function handleMove(direction) {
  let dir = null;
  switch(direction) {
    case 0: dir = {x:0,y:-1,axis:'y'}; break;  // Up
    case 1: dir = {x:1,y:0, axis:'x'}; break;  // Right
    case 2: dir = {x:0,y:1, axis:'y'}; break;  // Down
    case 3: dir = {x:-1,y:0,axis:'x'}; break;  // Left
  }
  if (!dir || isAnimating) return;
  
  // Reset chain counters for new move
  chainCount = 0;
  totalChainBlocks = 0;
  
  // If moves are 0, trigger game summary
  if (movesLeft <= 0) {
    isAnimating = true;
    setTimeout(() => {
      // Record current level score if not recorded yet
      if (!levelScores.length || levelScores[levelScores.length - 1].level !== currentLevel) {
        const levelScore = calculateLevelScore();
        levelScores.push({
          level: currentLevel,
          score: levelScore,
          remainingMoves: movesLeft
        });
      }
      // 直接顯示結算表
      showGameCompleteOverlay();
    }, 500);
    return;
  }
  
  movesLeft--; 
  updateUI();
  playMoveSound(); // Play move sound
  
  // 檢查步數是否耗盡
  if (movesLeft === 0) { 
    isAnimating = true; // 防止重複觸發
    setTimeout(() => {
      // 記錄當前關卡分數（包含遊戲分數）
      const levelScore = calculateLevelScore();
      levelScores.push({
        level: currentLevel,
        score: levelScore + gameScore, // Include current game score
        remainingMoves: movesLeft
      });
      
      // 步數歸零就直接結束遊戲，不管是否還有下一關
      showGameCompleteOverlay();
    }, 500); // 稍微延遲讓玩家看到移動效果
    return; 
  }
  
  isAnimating = true;
  cascade(dir);
}

// 鍵盤事件處理
document.addEventListener('keydown', e => {
  let direction = null;
  if (e.key==='ArrowUp')    { direction = 0; e.preventDefault(); }
  if (e.key==='ArrowDown')  { direction = 2; e.preventDefault(); }
  if (e.key==='ArrowLeft')  { direction = 3; e.preventDefault(); }
  if (e.key==='ArrowRight') { direction = 1; e.preventDefault(); }
  if (direction !== null) handleMove(direction);
});

// 觸控滑動支援
let touchStartX, touchStartY;
const gameContainer = document.getElementById('game');

// 觸控開始事件
gameContainer.addEventListener('touchstart', e => {
  // 如果點擊的是按鈕，就不處理滑動
  if (e.target.tagName === 'BUTTON') return;
  
  if (e.touches.length > 1) return; // 忽略多指觸控
  touchStartX = e.touches[0].clientX;
  touchStartY = e.touches[0].clientY;
  e.preventDefault();
});

// 觸控移動事件（防止頁面滾動）
gameContainer.addEventListener('touchmove', e => {
  // 如果點擊的是按鈕，就不阻止默認行為
  if (e.target.tagName === 'BUTTON') return;
  e.preventDefault();
});

// 防止整個文檔滾動
document.addEventListener('touchmove', e => {
  e.preventDefault();
}, { passive: false });

// 防止滾輪滾動
document.addEventListener('wheel', e => {
  e.preventDefault();
}, { passive: false });

// 觸控結束事件
gameContainer.addEventListener('touchend', e => {
  // 如果點擊的是按鈕，就不處理滑動
  if (e.target.tagName === 'BUTTON') return;
  
  if (e.touches.length > 0) return; // 如果還有手指在螢幕上就忽略
  
  const touchEndX = e.changedTouches[0].clientX;
  const touchEndY = e.changedTouches[0].clientY;
  
  const dx = touchEndX - touchStartX;
  const dy = touchEndY - touchStartY;
  const absDx = Math.abs(dx);
  const absDy = Math.abs(dy);
  
  // 滑動距離必須大於 30 像素才算有效滑動
  if (Math.max(absDx, absDy) > 30) {
    let direction;
    if (absDx > absDy) {
      // 水平滑動
      direction = dx > 0 ? 1 : 3; // 右:1, 左:3
    } else {
      // 垂直滑動
      direction = dy > 0 ? 2 : 0; // 下:2, 上:0
    }
    handleMove(direction);
  }
});

function cascade(dir) {
  compress(dir);
  setTimeout(() => {
    const matches = findMatches();
    if (matches.length === 0) { 
      // 連鎖結束，重置計數器
      chainCount = 0;
      totalChainBlocks = 0;
      
      // 檢查是否需要自動生成方塊
      checkAndGenerateLonelyTiles();
      isAnimating = false; 
      return; 
    }
    
    // 增加連鎖計數和累積方塊數
    chainCount++;
    totalChainBlocks += matches.length;
    
    // 顯示連鎖提示和播放音效
    if (matches.length >= 3 || chainCount > 1) {
      let comboText = '';
      
      // 基於消除數量的基本提示
      if (matches.length >= 12) comboText = 'LEGENDARY!';
      else if (matches.length >= 8) comboText = 'AMAZING!';
      else if (matches.length >= 5) comboText = 'COMBO!';
      else if (matches.length >= 3) comboText = 'NICE!';
      else comboText = 'HIT!';
      
      // 如果是連鎖，加強提示
      if (chainCount > 1) {
        if (chainCount >= 5) comboText = `🔥 GODLIKE x${chainCount} CHAIN! 🔥`;
        else if (chainCount >= 4) comboText = `⚡ ULTRA x${chainCount} CHAIN! ⚡`;
        else if (chainCount >= 3) comboText = `💥 MEGA x${chainCount} CHAIN! 💥`;
        else comboText = `✨ x${chainCount} CHAIN! ✨`;
      }
      
      // 如果累積消除數量很大，進一步加強
      if (totalChainBlocks >= 20) {
        comboText = `🌟 EPIC ${totalChainBlocks} BLOCKS! 🌟`;
      }
      
      showComboMessage(comboText);
    }
    
    // 播放基於消除數量和連鎖的動態音效
    if (matches.length > 0) {
      playEliminationSound(matches.length, chainCount - 1, totalChainBlocks);
    }
    
    removeMatches(matches, () => {
      if (boardMatrix.flat().every(v => !v)) {
        // 盤面清空，重置連鎖計數器
        chainCount = 0;
        totalChainBlocks = 0;
        
        // 檢查是否還有下一關
        if (currentLevel < Object.keys(LEVELS).length) {
          playLevelCompleteSound(); // Play level complete sound
          nextLevel(); // 正常過關，使用nextLevel
        } else {
          playLevelCompleteSound(); // Play completion sound
          // 所有關卡完成且盤面清空，顯示結算表
          showGameCompleteOverlay();
        }
      } else {
        setTimeout(() => cascade(dir), 200); // 稍微延長讓玩家看到效果
      }
    });
  }, 160);
}

function compress(dir) {
  const gameContainer = document.querySelector('.game-container');
  const containerRect = gameContainer.getBoundingClientRect();
  const containerSize = Math.min(containerRect.width, containerRect.height) - 32;
  const tileSize = (containerSize - (SIZE-1) * 8) / SIZE; // 根據SIZE動態計算
  const gap = 8;
  
  if (dir.axis==='x') {
    for (let y=0; y<SIZE; y++) {
      const elems = boardElements[y].filter(e=>e);
      const vals  = boardMatrix[y].filter(v=>v);
      const pad   = Array(SIZE-elems.length).fill(null);
      boardElements[y] = dir.x>0 ? [...pad,...elems] : [...elems,...pad];
      boardMatrix[y]   = dir.x>0 ? [...pad,...vals]  : [...vals,...pad];
      boardElements[y].forEach((t,i)=>{
        if(t) {
          const x = i * (tileSize + gap);
          const y_pos = y * (tileSize + gap);
          t.style.transform = `translate(${x}px, ${y_pos}px)`;
          t.style.width = `${tileSize}px`;
          t.style.height = `${tileSize}px`;
          t.style.lineHeight = `${tileSize}px`;
          t.style.fontSize = `${Math.min(tileSize * 0.6, 28)}px`;
        }
      });
    }
  } else {
    for (let x=0; x<SIZE; x++) {
      const elems=[], vals=[];
      for (let y=0; y<SIZE; y++) if(boardElements[y][x]){ elems.push(boardElements[y][x]); vals.push(boardMatrix[y][x]); }
      const pad = Array(SIZE-elems.length).fill(null);
      const newEls = dir.y>0 ? [...pad,...elems] : [...elems,...pad];
      const newVals= dir.y>0 ? [...pad,...vals]  : [...vals,...pad];
      for (let y=0; y<SIZE; y++) {
        boardElements[y][x]=newEls[y]; boardMatrix[y][x]=newVals[y];
        if (newEls[y]) {
          const x_pos = x * (tileSize + gap);
          const y_pos = y * (tileSize + gap);
          newEls[y].style.transform = `translate(${x_pos}px, ${y_pos}px)`;
          newEls[y].style.width = `${tileSize}px`;
          newEls[y].style.height = `${tileSize}px`;
          newEls[y].style.lineHeight = `${tileSize}px`;
          newEls[y].style.fontSize = `${Math.min(tileSize * 0.6, 28)}px`;
        }
      }
    }
  }
}

function findMatches() {
  const m = [];
  for (let y=0; y<SIZE; y++) for (let x=0; x<SIZE; x++) {
    const c=boardMatrix[y][x]; if(!c) continue;
    if (x<SIZE-1 && boardMatrix[y][x+1]===c) m.push([x,y],[x+1,y]);
    if (y<SIZE-1 && boardMatrix[y+1][x]===c) m.push([x,y],[x,y+1]);
  }
  return m.filter((v,i,a)=>a.findIndex(w=>w[0]===v[0]&&w[1]===v[1])===i);
}

function removeMatches(ms, cb) {
  // Calculate score
  const blockScore = ms.length * 10 * currentLevel; // 10 points per block, times level multiplier
  gameScore += blockScore;
  totalBlocks += ms.length;
  updateUI();
  
  // Show score increase message
  if (ms.length > 0) {
    showScoreMessage(`+${blockScore} points`, ms.length);
  }
  
  // 移除重複的combo訊息 - 這部分邏輯已經在上面的消除邏輯中處理了
  
  ms.forEach(([x,y],i) => setTimeout(() => {
    const t = boardElements[y][x];
    if (!t) return;
    
    // Mobile simplified effects - only show full effects for single or small removals
    const isMobile = window.innerWidth <= 768;
    const shouldShowFullEffect = !isMobile || ms.length <= 4;
    
    if (shouldShowFullEffect) {
      // Create flash effect
      createFlashEffect(t, x, y);
      
      // Create particle explosion
      createParticleExplosion(t, x, y);
    }
    
    // Add vibration (small range only)
    if (shouldShowFullEffect && navigator.vibrate) {
      navigator.vibrate(30);
    }
    
    boardElements[y][x] = null;
    boardMatrix[y][x] = null;
    t.classList.add('tile-remove');
    
    // Remove element
    setTimeout(() => {
      if (t.parentNode) t.parentNode.removeChild(t);
    }, 400);
    
  }, i * 60)); // Speed up removal
  
  setTimeout(cb, ms.length * 60 + 400);
}

// 文字特效管理器
let messageQueue = [];
let nextMessagePosition = 30; // 起始位置百分比
let lastComboMessage = ''; // 記錄上一個combo訊息
let lastComboTime = 0; // 記錄上一個combo訊息的時間

// Show score increase message
function showScoreMessage(text, blockCount) {
  const message = document.createElement('div');
  message.textContent = text;
  message.style.position = 'absolute';
  message.style.left = '50%';
  message.style.top = nextMessagePosition + '%';
  message.style.transform = 'translate(-50%, -50%)';
  message.style.fontSize = '1.5rem';
  message.style.fontWeight = 'bold';
  message.style.color = '#d4a574';
  message.style.background = 'rgba(255, 255, 255, 0.9)';
  message.style.padding = '0.5rem 1rem';
  message.style.borderRadius = '12px';
  message.style.textShadow = '1px 1px 2px rgba(0,0,0,0.1)';
  message.style.boxShadow = '0 4px 12px rgba(212, 165, 116, 0.3)';
  message.style.zIndex = '16';
  message.style.pointerEvents = 'none';
  message.style.whiteSpace = 'nowrap'; // 防止文字換行
  message.style.animation = 'combo-fade 1.5s ease-out forwards';
  
  // 更新下一個訊息位置
  nextMessagePosition += 8;
  if (nextMessagePosition > 70) {
    nextMessagePosition = 30; // 重置到頂部
  }
  
  document.querySelector('.game-container').appendChild(message);
  messageQueue.push(message);
  
  setTimeout(() => {
    if (message.parentNode) message.parentNode.removeChild(message);
    // 從佇列中移除
    const index = messageQueue.indexOf(message);
    if (index > -1) {
      messageQueue.splice(index, 1);
    }
    // 如果沒有其他訊息了，重置位置
    if (messageQueue.length === 0) {
      nextMessagePosition = 30;
    }
  }, 1500);
}

// Show combo message text
function showComboMessage(text) {
  const currentTime = Date.now();
  
  // 防止重複顯示相同的combo訊息（500ms內）
  if (text === lastComboMessage && currentTime - lastComboTime < 500) {
    return; // 跳過重複的訊息
  }
  
  lastComboMessage = text;
  lastComboTime = currentTime;
  
  const message = document.createElement('div');
  message.textContent = text;
  message.style.position = 'absolute';
  message.style.left = '50%';
  message.style.top = nextMessagePosition + '%';
  message.style.transform = 'translate(-50%, -50%)';
  message.style.fontSize = '2rem';
  message.style.fontWeight = 'bold';
  message.style.color = '#6b4e3d';
  message.style.textShadow = '2px 2px 4px rgba(0,0,0,0.3)';
  message.style.zIndex = '15';
  message.style.pointerEvents = 'none';
  message.style.whiteSpace = 'nowrap'; // 防止文字換行
  message.style.animation = 'combo-fade 1.5s ease-out forwards';
  
  // 更新下一個訊息位置
  nextMessagePosition += 8;
  if (nextMessagePosition > 70) {
    nextMessagePosition = 30; // 重置到頂部
  }
  
  document.querySelector('.game-container').appendChild(message);
  messageQueue.push(message);
  
  setTimeout(() => {
    if (message.parentNode) message.parentNode.removeChild(message);
    // 從佇列中移除
    const index = messageQueue.indexOf(message);
    if (index > -1) {
      messageQueue.splice(index, 1);
    }
    // 如果沒有其他訊息了，重置位置
    if (messageQueue.length === 0) {
      nextMessagePosition = 30;
    }
  }, 1500);
}

// Create flash effect - performance optimized
function createFlashEffect(tile, x, y) {
  const gameContainer = document.querySelector('.game-container');
  const containerRect = gameContainer.getBoundingClientRect();
  const containerSize = Math.min(containerRect.width, containerRect.height) - 32;
  const tileSize = (containerSize - (SIZE-1) * 8) / SIZE; // 根據SIZE動態計算
  const gap = 8;
  
  const centerX = x * (tileSize + gap);
  const centerY = y * (tileSize + gap);
  
  // Simplified flash effect - remove complex style calculations
  const flashTile = document.createElement('div');
  flashTile.className = tile.className.replace('tile-new', '').replace('tile-remove', '');
  flashTile.style.position = 'absolute';
  flashTile.style.left = centerX + 'px';
  flashTile.style.top = centerY + 'px';
  flashTile.style.width = tileSize + 'px';
  flashTile.style.height = tileSize + 'px';
  flashTile.style.borderRadius = '12px';
  flashTile.style.animation = 'tile-pulse 500ms ease-out 1'; // Shorter animation
  flashTile.style.zIndex = '20';
  flashTile.style.pointerEvents = 'none';
  
  document.querySelector('.tile-container').appendChild(flashTile);
  
  setTimeout(() => {
    if (flashTile.parentNode) flashTile.parentNode.removeChild(flashTile);
  }, 500);
}

// Create particle explosion - performance optimized
function createParticleExplosion(tile, x, y) {
  const isMobile = window.innerWidth <= 768;
  const gameContainer = document.querySelector('.game-container');
  let centerX, centerY, tileSize;
  
  if (isMobile) {
    const containerWidth = gameContainer.offsetWidth;
    tileSize = (containerWidth * 0.94 - containerWidth * 0.02 * (SIZE-1)) / SIZE; // Calculate dynamically based on SIZE
    const gap = containerWidth * 0.02;
    
    const tileContainer = document.querySelector('.tile-container');
    const containerRect = gameContainer.getBoundingClientRect();
    const tileContainerRect = tileContainer.getBoundingClientRect();
    
    const offsetX = tileContainerRect.left - containerRect.left;
    const offsetY = tileContainerRect.top - containerRect.top;
    
    centerX = offsetX + x * (tileSize + gap) + tileSize / 2;
    centerY = offsetY + y * (tileSize + gap) + tileSize / 2;
  } else {
    // Desktop version - calculate dynamically based on SIZE
    const gameContainer = document.querySelector('.game-container');
    const containerRect = gameContainer.getBoundingClientRect();
    const containerSize = Math.min(containerRect.width, containerRect.height) - 32;
    tileSize = (containerSize - (SIZE-1) * 8) / SIZE;
    const gap = 8;
    centerX = 15 + x * (tileSize + gap) + tileSize / 2;
    centerY = 15 + y * (tileSize + gap) + tileSize / 2;
  }
  
  // Get tile color
  const computedStyle = window.getComputedStyle(tile);
  const bgColor = computedStyle.backgroundColor;
  
  // Reduce particle count - mobile 6, desktop 8
  const particleCount = isMobile ? 6 : 8;
  for (let i = 0; i < particleCount; i++) {
    const particle = document.createElement('div');
    particle.className = 'particle';
    particle.style.background = bgColor;
    particle.style.left = centerX + 'px';
    particle.style.top = centerY + 'px';
    
    // Random direction and distance - smaller range
    const angle = (i / particleCount) * Math.PI * 2;
    const distance = 50 + Math.random() * 30; // Smaller explosion range
    const dx = Math.cos(angle) * distance + 'px';
    const dy = Math.sin(angle) * distance + 'px';
    
    particle.style.setProperty('--dx', dx);
    particle.style.setProperty('--dy', dy);
    
    gameContainer.appendChild(particle);
    
    // Remove particles early
    setTimeout(() => {
      if (particle.parentNode) particle.parentNode.removeChild(particle);
    }, 400);
  }
  
  // Simplified ripple effect - remove complex styles
  const ripple = document.createElement('div');
  ripple.style.position = 'absolute';
  ripple.style.left = (centerX - tileSize/2) + 'px';
  ripple.style.top = (centerY - tileSize/2) + 'px';
  ripple.style.width = tileSize + 'px';
  ripple.style.height = tileSize + 'px';
  ripple.style.borderRadius = '50%';
  ripple.style.background = `radial-gradient(circle, ${bgColor}30 0%, transparent 70%)`;
  ripple.style.animation = 'ripple-effect 300ms ease-out forwards'; // Shorter time
  ripple.style.pointerEvents = 'none';
  ripple.style.zIndex = '12';
  
  gameContainer.appendChild(ripple);
  
  setTimeout(() => {
    if (ripple.parentNode) ripple.parentNode.removeChild(ripple);
  }, 300);
}

// Check lonely tiles and auto-generate
function checkAndGenerateLonelyTiles() {
  // Count each color
  const colorCounts = {};
  PROPS.forEach(color => colorCounts[color] = 0);
  
  for (let y = 0; y < SIZE; y++) {
    for (let x = 0; x < SIZE; x++) {
      const color = boardMatrix[y][x];
      if (color) {
        colorCounts[color]++;
      }
    }
  }
  
  // Find colors with only one tile
  const lonelyColors = [];
  Object.keys(colorCounts).forEach(color => {
    if (colorCounts[color] === 1) {
      lonelyColors.push(color);
    }
  });
  
  // Generate new tile for each lonely color
  lonelyColors.forEach(color => {
    generateTileForColor(color);
  });
}

// Generate new tile for specific color
function generateTileForColor(color) {
  // Check if moves remaining
  if (movesLeft <= 0) return;
  
  // Find all empty positions
  const emptyPositions = [];
  for (let y = 0; y < SIZE; y++) {
    for (let x = 0; x < SIZE; x++) {
      if (boardMatrix[y][x] === null) {
        emptyPositions.push({x, y});
      }
    }
  }
  
  // Don't generate if no empty positions
  if (emptyPositions.length === 0) return;
  
  // Randomly choose an empty position
  const randomIndex = Math.floor(Math.random() * emptyPositions.length);
  const position = emptyPositions[randomIndex];
  
  // Generate new tile
  boardMatrix[position.y][position.x] = color;
  boardElements[position.y][position.x] = createTile(position.x, position.y, color);
  
  // Use one move
  movesLeft--;
  updateUI();
  
  // Show message
  showAutoGenerateMessage(color);
  
  // Check if moves finished
  if (movesLeft === 0) {
    setTimeout(() => {
      // Record current level score if not recorded yet
      if (!levelScores.length || levelScores[levelScores.length - 1].level !== currentLevel) {
        const levelScore = calculateLevelScore();
        levelScores.push({
          level: currentLevel,
          score: levelScore,
          remainingMoves: movesLeft
        });
      }
      // Show game summary
      showGameCompleteOverlay();
    }, 1500); // Let player see generation effect before showing summary
  }
}

// Show auto-generate message
function showAutoGenerateMessage(color) {
  const colorNames = {
    'red': 'Red',
    'green': 'Green', 
    'blue': 'Blue',
    'purple': 'Purple',
    'orange': 'Yellow',
    'pink': 'Pink',
    'cyan': 'Cyan'
  };
  
  const message = document.createElement('div');
  message.textContent = `New ${colorNames[color]} Block Added (-1 move)`;
  message.style.position = 'absolute';
  message.style.left = '50%';
  message.style.top = '30%';
  message.style.transform = 'translate(-50%, -50%)';
  message.style.fontSize = '1.2rem';
  message.style.fontWeight = 'bold';
  message.style.color = '#6b4e3d';
  message.style.background = 'rgba(255, 255, 255, 0.9)';
  message.style.padding = '0.5rem 1rem';
  message.style.borderRadius = '12px';
  message.style.textShadow = '1px 1px 2px rgba(0,0,0,0.1)';
  message.style.boxShadow = '0 4px 12px rgba(0,0,0,0.2)';
  message.style.zIndex = '15';
  message.style.pointerEvents = 'none';
  message.style.animation = 'combo-fade 2s ease-out forwards';
  
  document.querySelector('.game-container').appendChild(message);
  
  setTimeout(() => {
    if (message.parentNode) message.parentNode.removeChild(message);
  }, 2000);
}

// Recalculate positions when window resizes
window.addEventListener('resize', () => {
  const gameContainer = document.querySelector('.game-container');
  const containerRect = gameContainer.getBoundingClientRect();
  const containerSize = Math.min(containerRect.width, containerRect.height) - 32;
  const tileSize = (containerSize - (SIZE-1) * 8) / SIZE; // Calculate dynamically based on SIZE
  const gap = 8;
  
  for (let y = 0; y < SIZE; y++) {
    for (let x = 0; x < SIZE; x++) {
      const tile = boardElements[y][x];
      if (tile) {
        const x_pos = x * (tileSize + gap);
        const y_pos = y * (tileSize + gap);
        tile.style.transform = `translate(${x_pos}px, ${y_pos}px)`;
        tile.style.width = `${tileSize}px`;
        tile.style.height = `${tileSize}px`;
        tile.style.lineHeight = `${tileSize}px`;
        tile.style.fontSize = `${Math.min(tileSize * 0.6, 28)}px`;
      }
    }
  }
});

// Instructions button event listener
instructionsBtn.addEventListener('click', () => {
  hideOverlay();
});

instructionsBtn.addEventListener('touchend', function(e) {
  e.preventDefault();
  e.stopPropagation();
  hideOverlay();
});

// 添加觸控支援給指示畫面
instructionsDiv.addEventListener('click', function(e) {
  e.stopPropagation();
  // 在手機上點擊指示框也能開始遊戲
  if (window.innerWidth <= 768) {
    overlay.removeEventListener('click', startGameFromInstructions);
    overlay.removeEventListener('touchend', startGameFromInstructionsTouch);
    hideOverlay();
  }
});

instructionsDiv.addEventListener('touchend', function(e) {
  e.preventDefault();
  e.stopPropagation();
  // 觸控指示框開始遊戲
  overlay.removeEventListener('click', startGameFromInstructions);
  overlay.removeEventListener('touchend', startGameFromInstructionsTouch);
  hideOverlay();
});

initBoard();
// Show instructions when first loading the game
setTimeout(() => showInstructions(), 500);

// Additional functionality for new content
document.getElementById('aboutBtn').addEventListener('click', () => {
  playButtonSound();
  document.getElementById('gameInfo').style.display = 'block';
  document.getElementById('gameFooter').style.display = 'none';
});

document.getElementById('helpBtn').addEventListener('click', () => {
  playButtonSound();
  document.getElementById('helpSection').style.display = 'block';
  document.getElementById('gameFooter').style.display = 'none';
});

// Modal functions
function showPrivacyPolicy() {
  document.getElementById('privacyModal').style.display = 'block';
}

function showTermsOfService() {
  document.getElementById('termsModal').style.display = 'block';
}

function showContact() {
  document.getElementById('contactModal').style.display = 'block';
}

function closeModal(modalId) {
  document.getElementById(modalId).style.display = 'none';
}

// Close modals when clicking outside
window.onclick = function(event) {
  const modals = ['privacyModal', 'termsModal', 'contactModal'];
  modals.forEach(modalId => {
    const modal = document.getElementById(modalId);
    if (event.target === modal) {
      modal.style.display = 'none';
    }
  });
}

// Share functionality
function shareGame(platform) {
  const url = encodeURIComponent(window.location.href);
  const title = encodeURIComponent('Check out RectBlox - An amazing puzzle game!');
  
  let shareUrl = '';
  if (platform === 'twitter') {
    shareUrl = `https://twitter.com/intent/tweet?url=${url}&text=${title}`;
  } else if (platform === 'facebook') {
    shareUrl = `https://www.facebook.com/sharer/sharer.php?u=${url}`;
  }
  
  if (shareUrl) {
    window.open(shareUrl, '_blank', 'width=600,height=400');
  }
}

// Contact form submission
function submitContactForm(event) {
  event.preventDefault();
  
  // Get form data
  const formData = new FormData(event.target);
  const data = {
    name: formData.get('name'),
    email: formData.get('email'),
    subject: formData.get('subject'),
    message: formData.get('message')
  };
  
  // Simple validation
  if (!data.name || !data.email || !data.subject || !data.message) {
    alert('Please fill in all fields.');
    return;
  }
  
  // Simulate form submission
  alert('Thank you for your message! We will get back to you soon.');
  closeModal('contactModal');
  event.target.reset();
}

// Show footer by default
document.getElementById('gameFooter').style.display = 'block';

// Add keyboard shortcuts for accessibility
document.addEventListener('keydown', function(e) {
  // Escape key closes modals and info sections
  if (e.key === 'Escape') {
    // Close modals
    closeModal('privacyModal');
    closeModal('termsModal');
    closeModal('contactModal');
    
    // Close info sections
    document.getElementById('gameInfo').style.display = 'none';
    document.getElementById('helpSection').style.display = 'none';
    document.getElementById('gameFooter').style.display = 'block';
  }
});

// Add smooth scrolling for better UX
document.querySelectorAll('a[href^="#"]').forEach(anchor => {
  anchor.addEventListener('click', function (e) {
    e.preventDefault();
    const target = document.querySelector(this.getAttribute('href'));
    if (target) {
      target.scrollIntoView({
        behavior: 'smooth',
        block: 'start'
      });
    }
  });
});

// Analytics and user engagement tracking (privacy-friendly)
function trackGameEvent(eventName, data = {}) {
  // Store basic game statistics locally for improvement
  const stats = JSON.parse(localStorage.getItem('rectbloxStats') || '{}');
  
  if (!stats[eventName]) {
    stats[eventName] = 0;
  }
  stats[eventName]++;
  
  // Add timestamp for session tracking
  stats.lastPlayed = new Date().toISOString();
  
  localStorage.setItem('rectbloxStats', JSON.stringify(stats));
}

// Track game start
const originalInitBoard = initBoard;
initBoard = function() {
  trackGameEvent('gameStart');
  return originalInitBoard.apply(this, arguments);
};

// Track game completion
const originalShowGameCompleteOverlay = showGameCompleteOverlay;
showGameCompleteOverlay = function() {
  trackGameEvent('gameComplete');
  return originalShowGameCompleteOverlay.apply(this, arguments);
};

// Page load and performance tracking
window.addEventListener('load', function() {
  // Track page load time
  const loadTime = performance.now();
  trackGameEvent('pageLoad', { loadTime: Math.round(loadTime) });
  
  // Initialize user engagement tracking
  let engagementStartTime = Date.now();
  let isEngaged = true;
  
  // Track user engagement time
  document.addEventListener('visibilitychange', function() {
    if (document.hidden) {
      if (isEngaged) {
        const engagementTime = Date.now() - engagementStartTime;
        trackGameEvent('engagement', { time: Math.round(engagementTime / 1000) });
        isEngaged = false;
      }
    } else {
      engagementStartTime = Date.now();
      isEngaged = true;
    }
  });
  
  // Track before user leaves
  window.addEventListener('beforeunload', function() {
    if (isEngaged) {
      const engagementTime = Date.now() - engagementStartTime;
      trackGameEvent('engagement', { time: Math.round(engagementTime / 1000) });
    }
  });
});

// Service Worker for PWA functionality (optional)
if ('serviceWorker' in navigator) {
  window.addEventListener('load', function() {
    navigator.serviceWorker.register('/sw.js')
      .then(function(registration) {
        console.log('ServiceWorker registration successful');
      })
      .catch(function(err) {
        console.log('ServiceWorker registration failed');
      });
  });
}

// Add to home screen prompt
let deferredPrompt;
window.addEventListener('beforeinstallprompt', (e) => {
  e.preventDefault();
  deferredPrompt = e;
  
  // Show install button after user has engaged with the game
  setTimeout(() => {
    if (deferredPrompt) {
      showInstallPrompt();
    }
  }, 60000); // Show after 1 minute of gameplay
});

function showInstallPrompt() {
  const installBanner = document.createElement('div');
  installBanner.innerHTML = `
    <div style="position: fixed; bottom: 20px; right: 20px; background: rgba(212, 165, 116, 0.95); color: white; padding: 1rem; border-radius: 10px; z-index: 1000; max-width: 250px; box-shadow: 0 4px 12px rgba(0,0,0,0.3);">
      <p style="margin: 0 0 0.5rem 0; font-size: 0.9rem;">Install RectBlox for the best experience!</p>
      <button onclick="installApp()" style="background: white; color: #6b4e3d; border: none; padding: 0.5rem 1rem; border-radius: 5px; cursor: pointer; margin-right: 0.5rem;">Install</button>
      <button onclick="dismissInstall()" style="background: transparent; color: white; border: 1px solid white; padding: 0.5rem 1rem; border-radius: 5px; cursor: pointer;">Later</button>
    </div>
  `;
  document.body.appendChild(installBanner);
  
  window.installApp = function() {
    if (deferredPrompt) {
      deferredPrompt.prompt();
      deferredPrompt.userChoice.then((choiceResult) => {
        if (choiceResult.outcome === 'accepted') {
          trackGameEvent('appInstalled');
        }
        deferredPrompt = null;
        document.body.removeChild(installBanner);
      });
    }
  };
  
  window.dismissInstall = function() {
    document.body.removeChild(installBanner);
    deferredPrompt = null;
  };
}
</script>

    <div class="action-buttons">
      <button class="secondary-button" id="aboutBtn">About Game</button>
      <button class="secondary-button" id="helpBtn">Help</button>
    </div>
  </div>
  
  <!-- Additional Game Content -->
  <div class="game-info" id="gameInfo" style="display: none;">
    <div class="content-section">
      <h2>About RectBlox</h2>
      <p>RectBlox is an engaging match-3 block puzzle game that challenges your strategic thinking and pattern recognition skills. Developed with modern web technologies, this game offers hours of entertainment for puzzle game enthusiasts of all ages.</p>
      
      <h3>Game Features</h3>
      <ul>
        <li><strong>5 Progressive Levels:</strong> Each level increases in difficulty with unique challenges</li>
        <li><strong>Intuitive Controls:</strong> Simple swipe gestures on mobile, arrow keys on desktop</li>
        <li><strong>Dynamic Scoring:</strong> Score system that rewards strategic play and combo chains</li>
        <li><strong>Responsive Design:</strong> Optimized for both mobile and desktop gameplay</li>
        <li><strong>Audio Feedback:</strong> Satisfying sound effects enhance the gaming experience</li>
        <li><strong>Visual Effects:</strong> Smooth animations and particle effects</li>
      </ul>
      
      <h3>How to Play</h3>
      <div class="gameplay-guide">
        <div class="step">
          <h4>1. Movement</h4>
          <p><strong>Desktop:</strong> Use arrow keys (←↑→↓) to move all blocks in the chosen direction</p>
          <p><strong>Mobile:</strong> Swipe in any direction to move blocks</p>
        </div>
        <div class="step">
          <h4>2. Matching</h4>
          <p>When two or more blocks of the same color touch, they disappear and you score points</p>
        </div>
        <div class="step">
          <h4>3. Strategy</h4>
          <p>Plan your moves carefully - you have limited moves per level. Create chain reactions for bonus points!</p>
        </div>
        <div class="step">
          <h4>4. Special Features</h4>
          <p><strong>Reset Position:</strong> Costs 1 move but randomly redistributes all blocks</p>
          <p><strong>Auto-generation:</strong> The game automatically adds blocks to prevent impossible situations</p>
        </div>
      </div>
      
      <h3>Tips for Success</h3>
      <ul>
        <li>Look for opportunities to create chain reactions</li>
        <li>Don't waste moves - think before each move</li>
        <li>Use the reset position feature strategically when stuck</li>
        <li>Focus on clearing larger groups for higher scores</li>
        <li>Practice pattern recognition to spot matches quickly</li>
      </ul>
    </div>
    
    <div class="content-section">
      <h3>Game Statistics & Achievements</h3>
      <p>Track your progress as you master RectBlox:</p>
      <ul>
        <li><strong>Score Tracking:</strong> Your best scores are saved locally</li>
        <li><strong>Level Progress:</strong> Complete all 5 levels to become a RectBlox master</li>
        <li><strong>Combo System:</strong> Chain eliminations for spectacular combo messages</li>
        <li><strong>Efficiency Rating:</strong> Use fewer moves for higher efficiency scores</li>
      </ul>
    </div>
    
    <div class="content-section">
      <h3>Technical Information</h3>
      <p>RectBlox is built using modern web technologies:</p>
      <ul>
        <li><strong>HTML5 & CSS3:</strong> For responsive design and animations</li>
        <li><strong>JavaScript:</strong> Game logic and interactive features</li>
        <li><strong>Touch API:</strong> Native mobile touch support</li>
        <li><strong>Web Audio API:</strong> Dynamic sound generation</li>
        <li><strong>Local Storage:</strong> Save progress and preferences</li>
      </ul>
    </div>
    
    <button class="secondary-button" onclick="document.getElementById('gameInfo').style.display='none'">Back to Game</button>
  </div>
  
  <!-- Help Section -->
  <div class="help-section" id="helpSection" style="display: none;">
    <div class="content-section">
      <h2>Frequently Asked Questions</h2>
      
      <div class="faq-item">
        <h4>Q: How do I control the game?</h4>
        <p>A: On desktop, use arrow keys. On mobile devices, simply swipe in the direction you want to move the blocks.</p>
      </div>
      
      <div class="faq-item">
        <h4>Q: What happens when I run out of moves?</h4>
        <p>A: The game will show your final score and statistics. You can then restart to try again and improve your score.</p>
      </div>
      
      <div class="faq-item">
        <h4>Q: How does the scoring system work?</h4>
        <p>A: You earn 10 points per block eliminated, multiplied by the current level. Chain reactions and larger eliminations give bonus points.</p>
      </div>
      
      <div class="faq-item">
        <h4>Q: Can I save my progress?</h4>
        <p>A: Yes! The game automatically saves your best scores and current progress using your browser's local storage.</p>
      </div>
      
      <div class="faq-item">
        <h4>Q: Is RectBlox free to play?</h4>
        <p>A: Absolutely! RectBlox is completely free to play with no hidden costs or in-app purchases.</p>
      </div>
      
      <div class="faq-item">
        <h4>Q: Does the game work offline?</h4>
        <p>A: Yes, once loaded, RectBlox can be played offline. However, you'll need an internet connection to initially load the game.</p>
      </div>
    </div>
    
    <div class="content-section">
      <h3>Troubleshooting</h3>
      <ul>
        <li><strong>Game not responding:</strong> Try refreshing the page</li>
        <li><strong>Audio issues:</strong> Check your device's volume settings</li>
        <li><strong>Touch not working:</strong> Ensure your browser supports touch events</li>
        <li><strong>Performance issues:</strong> Close other browser tabs for better performance</li>
      </ul>
    </div>
    
    <button class="secondary-button" onclick="document.getElementById('helpSection').style.display='none'">Back to Game</button>
  </div>
  
  <!-- Footer Content -->
  <footer class="game-footer" id="gameFooter">
    <!-- Ad Space - Footer Banner -->
    <div class="ad-container" style="text-align: center; margin: 1rem 0; padding: 1rem; background: rgba(255,255,255,0.1); border-radius: 10px;">
      <ins class="adsbygoogle"
           style="display:block"
           data-ad-client="ca-pub-6244767628762401"
           data-ad-slot="1234567890"
           data-ad-format="auto"
           data-full-width-responsive="true"></ins>
      <script>
           (adsbygoogle = window.adsbygoogle || []).push({});
      </script>
    </div>
    
    <div class="footer-content">
      <div class="footer-section">
        <h4>RectBlox Game</h4>
        <p>© 2024 RectBlox. A free online puzzle game for everyone.</p>
        <p>Version 1.0 - Last updated: December 2024</p>
      </div>
      
      <div class="footer-links">
        <a href="#" onclick="showPrivacyPolicy()">Privacy Policy</a>
        <a href="#" onclick="showTermsOfService()">Terms of Service</a>
        <a href="#" onclick="showContact()">Contact Us</a>
      </div>
      
      <div class="footer-section">
        <h4>Share RectBlox</h4>
        <p>Enjoyed the game? Share it with friends!</p>
        <div class="share-buttons">
          <button onclick="shareGame('twitter')" class="share-btn">Share on Twitter</button>
          <button onclick="shareGame('facebook')" class="share-btn">Share on Facebook</button>
        </div>
      </div>
    </div>
    
    <!-- Additional Ad Space - Bottom -->
    <div class="ad-container" style="text-align: center; margin-top: 1rem;">
      <ins class="adsbygoogle"
           style="display:block"
           data-ad-client="ca-pub-6244767628762401"
           data-ad-slot="9876543210"
           data-ad-format="auto"
           data-full-width-responsive="true"></ins>
      <script>
           (adsbygoogle = window.adsbygoogle || []).push({});
      </script>
    </div>
  </footer>
  
  <!-- Privacy Policy Modal -->
  <div id="privacyModal" class="modal" style="display: none;">
    <div class="modal-content">
      <span class="close" onclick="closeModal('privacyModal')">&times;</span>
      <h2>Privacy Policy</h2>
      <p><strong>Last updated:</strong> December 2024</p>
      
      <h3>Information We Collect</h3>
      <p>RectBlox is designed with privacy in mind. We collect minimal information to provide you with the best gaming experience:</p>
      <ul>
        <li><strong>Game Data:</strong> Your scores and progress are stored locally on your device</li>
        <li><strong>Technical Data:</strong> Basic browser information for game optimization</li>
        <li><strong>Usage Analytics:</strong> Anonymous gameplay statistics to improve the game</li>
      </ul>
      
      <h3>How We Use Information</h3>
      <ul>
        <li>To save your game progress and high scores</li>
        <li>To optimize game performance for your device</li>
        <li>To understand how players interact with the game</li>
        <li>To improve game features and fix bugs</li>
      </ul>
      
      <h3>Data Storage</h3>
      <p>Your game data is stored locally on your device using browser storage. We do not collect or store personal information on external servers.</p>
      
      <h3>Third-Party Services</h3>
      <p>RectBlox may include advertising from Google AdSense. Please refer to Google's Privacy Policy for information about how Google collects and uses data.</p>
      
      <h3>Contact</h3>
      <p>If you have questions about this Privacy Policy, please contact us through the contact form.</p>
    </div>
  </div>
  
  <!-- Terms of Service Modal -->
  <div id="termsModal" class="modal" style="display: none;">
    <div class="modal-content">
      <span class="close" onclick="closeModal('termsModal')">&times;</span>
      <h2>Terms of Service</h2>
      <p><strong>Last updated:</strong> December 2024</p>
      
      <h3>Acceptance of Terms</h3>
      <p>By playing RectBlox, you agree to these Terms of Service. If you do not agree, please do not use the game.</p>
      
      <h3>Game Usage</h3>
      <ul>
        <li>RectBlox is free to play for personal, non-commercial use</li>
        <li>You may not modify, distribute, or create derivative works of the game</li>
        <li>You may not use automated tools or bots to play the game</li>
        <li>Fair play is expected - no cheating or exploitation of bugs</li>
      </ul>
      
      <h3>Intellectual Property</h3>
      <p>RectBlox and all related content are protected by copyright and other intellectual property laws. All rights reserved.</p>
      
      <h3>Disclaimer</h3>
      <p>The game is provided "as is" without warranties. We are not liable for any damages from using the game.</p>
      
      <h3>Changes to Terms</h3>
      <p>We may update these terms. Continued use of the game constitutes acceptance of updated terms.</p>
    </div>
  </div>
  
  <!-- Contact Modal -->
  <div id="contactModal" class="modal" style="display: none;">
    <div class="modal-content">
      <span class="close" onclick="closeModal('contactModal')">&times;</span>
      <h2>Contact Us</h2>
      
      <h3>Get in Touch</h3>
      <p>We'd love to hear from you! Whether you have feedback, questions, or just want to share your high score, we're here to help.</p>
      
      <div class="contact-form">
        <h4>Send us a message:</h4>
        <form onsubmit="submitContactForm(event)">
          <div class="form-group">
            <label for="contactName">Name:</label>
            <input type="text" id="contactName" name="name" required>
          </div>
          
          <div class="form-group">
            <label for="contactEmail">Email:</label>
            <input type="email" id="contactEmail" name="email" required>
          </div>
          
          <div class="form-group">
            <label for="contactSubject">Subject:</label>
            <select id="contactSubject" name="subject" required>
              <option value="">Select a topic</option>
              <option value="feedback">Game Feedback</option>
              <option value="bug">Bug Report</option>
              <option value="suggestion">Feature Suggestion</option>
              <option value="other">Other</option>
            </select>
          </div>
          
          <div class="form-group">
            <label for="contactMessage">Message:</label>
            <textarea id="contactMessage" name="message" rows="5" required></textarea>
          </div>
          
          <button type="submit" class="submit-btn">Send Message</button>
        </form>
      </div>
      
      <div class="contact-info">
        <h4>Other ways to reach us:</h4>
        <p><strong>Response Time:</strong> We typically respond within 24-48 hours</p>
        <p><strong>Languages:</strong> English, 中文</p>
      </div>
    </div>
  </div>

<!-- Hidden SEO Content -->
<div style="position: absolute; left: -9999px; top: -9999px; visibility: hidden;">
  <h1>RectBlox - Free Online Puzzle Game</h1>
  <h2>Match-3 Block Puzzle Game Features</h2>
  <p>Experience the ultimate puzzle gaming adventure with RectBlox! This engaging match-3 block puzzle game offers:</p>
  <ul>
    <li>5 challenging levels with increasing difficulty</li>
    <li>Smooth gameplay on mobile and desktop</li>
    <li>Colorful blocks and satisfying combos</li>
    <li>Free to play online game</li>
    <li>No download required</li>
    <li>Perfect for casual gaming sessions</li>
  </ul>
  <h3>How to Play RectBlox</h3>
  <p>Swipe or click to move blocks and create matches of 3 or more identical blocks. Clear the board to advance through levels and achieve high scores!</p>
  
  <h3>Benefits of Playing Puzzle Games</h3>
  <p>Research shows that puzzle games like RectBlox can help improve cognitive function, enhance problem-solving skills, and provide stress relief through engaging gameplay.</p>
  
  <h3>Game Development and Technology</h3>
  <p>RectBlox utilizes modern web technologies including HTML5, CSS3, and JavaScript to deliver a smooth, responsive gaming experience across all devices and platforms.</p>
</div>

</body>
</html>
